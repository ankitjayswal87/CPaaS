exten => 1234,1,Answer()
same => n,Noop(EXTEN : ${EXTEN:-10})
same => n,Set(exten=${EXTEN:-10})
same => n,Set(callerid=${CALLERID(num)})
same => n,AGI(cpass/in_cpass.py,${EXTEN:-10},${UNIQUEID},${CALLERID(num)})
same => n,Gotoif($["${app}"="play"]?goto_play:)
same => n,Gotoif($["${app}"="say"]?goto_say:)
same => n,Gotoif($["${app}"="collect"]?goto_collect:)
same => n,Gotoif($["${app}"="dial_number"]?goto_dial_number:)
same => n,Gotoif($["${app}"="dial_sip"]?goto_dial_sip:)
same => n,Gotoif($["${app}"="voicemail"]?goto_voicemail:)
same => n,Gotoif($["${app}"="voicebot"]?goto_voicebot:)
same => n(goto_play),Goto(play,s,1)
same => n,Hangup()
same => n(goto_say),Goto(say,s,1)
same => n,Hangup()
same => n(goto_collect),Goto(collect,s,1)
same => n,Hangup()
same => n(goto_dial_number),Goto(dial_number,s,1)
same => n,Hangup()
same => n(goto_dial_sip),Goto(dial_sip,s,1)
same => n,Hangup()
same => n(goto_voicemail),Goto(voicemail,s,1)
same => n,Hangup()
same => n(goto_voicebot),Goto(voicebot,s,1)
same => n,Hangup()


[play]
exten => s,1,Noop(Play the file...)
same => n,Playback(${url})
same => n,Hangup()

[say]
exten => s,1,Noop(Say the text...)
same => n,Noop(${text})
same => n,Set(text=${URIENCODE(${text})})
same => n,System(python3 /var/lib/asterisk/agi-bin/cpass/text_to_speech_cpass.py ${UNIQUEID}_say ${text} ${voice})
same => n,System(sox /tmp/${UNIQUEID}_say.wav -r 8000 /tmp/${UNIQUEID}_say1.wav)
same => n,Playback(/tmp/${UNIQUEID}_say1)
same => n,System(rm /tmp/${UNIQUEID}_say.wav)
same => n,System(rm /tmp/${UNIQUEID}_say1.wav)
same => n,Hangup()

[collect]
exten => s,1,Noop(Collect the digits...)
same => n,Noop(${text})
same => n,Set(text=${URIENCODE(${text})})
same => n,System(python3 /var/lib/asterisk/agi-bin/cpass/text_to_speech_cpass.py ${UNIQUEID}_say ${text} ${voice})
same => n,System(sox /tmp/${UNIQUEID}_say.wav -r 8000 /tmp/${UNIQUEID}_say1.wav)
same => n,Read(pressed_digit,/tmp/${UNIQUEID}_say1,${numdigits},n,${attempts},${timeout})
same => n,Noop(THE READ STATUS IS ${READSTATUS})
same => n,System(rm /tmp/${UNIQUEID}_say.wav)
same => n,System(rm /tmp/${UNIQUEID}_say1.wav)
same => n,AGI(cpass/process_digits_cpass.py,${READSTATUS},${pressed_digit},${URIENCODE(${action})})
same => n,Gotoif($["${app}"="play"]?goto_play:)
same => n,Gotoif($["${app}"="say"]?goto_say:)
same => n,Gotoif($["${app}"="collect"]?goto_collect:)
same => n,Gotoif($["${app}"="dial_number"]?goto_dial_number:)
same => n,Gotoif($["${app}"="dial_sip"]?goto_dial_sip:)
same => n,Gotoif($["${app}"="voicemail"]?goto_voicemail:)
same => n,Gotoif($["${app}"="voicebot"]?goto_voicebot:)
same => n(goto_play),Goto(play,s,1)
same => n,Hangup()
same => n(goto_say),Goto(say,s,1)
same => n,Hangup()
same => n(goto_collect),Goto(collect,s,1)
same => n,Hangup()
same => n(goto_dial_number),Goto(dial_number,s,1)
same => n,Hangup()
same => n(goto_dial_sip),Goto(dial_sip,s,1)
same => n,Hangup()
same => n(goto_voicemail),Goto(voicemail,s,1)
same => n,Hangup()
same => n(goto_voicebot),Goto(voicebot,s,1)
same => n,Hangup()

[dial_number]
exten => s,1,Noop(Dial phone numbers...)
same => n,Dial(${numbers},${timeout})
same => n,Noop(DialStatus is ${DIALSTATUS})
same => n,AGI(cpass/dial_number_status_cpass.py,${DIALSTATUS},${URIENCODE(${action})},${UNIQUEID},${exten},${callerid},${account_id},${numbers})
same => n,Gotoif($["${app}"="play"]?goto_play:)
same => n,Gotoif($["${app}"="say"]?goto_say:)
same => n,Gotoif($["${app}"="collect"]?goto_collect:)
same => n,Gotoif($["${app}"="dial_number"]?goto_dial_number:)
same => n,Gotoif($["${app}"="dial_sip"]?goto_dial_sip:)
same => n,Gotoif($["${app}"="voicemail"]?goto_voicemail:)
same => n,Gotoif($["${app}"="voicebot"]?goto_voicebot:)
same => n(goto_play),Goto(play,s,1)
same => n,Hangup()
same => n(goto_say),Goto(say,s,1)
same => n,Hangup()
same => n(goto_collect),Goto(collect,s,1)
same => n,Hangup()
same => n(goto_dial_number),Goto(dial_number,s,1)
same => n,Hangup()
same => n(goto_dial_sip),Goto(dial_sip,s,1)
same => n,Hangup()
same => n(goto_voicemail),Goto(voicemail,s,1)
same => n,Hangup()
same => n(goto_voicebot),Goto(voicebot,s,1)
same => n,Hangup()

[dial_sip]
exten => s,1,Noop(Dial SIP Agents...)
same => n,Dial(${agents},${timeout})
same => n,Noop(DialStatus is ${DIALSTATUS})
same => n,AGI(cpass/dial_sip_status_cpass.py,${DIALSTATUS},${URIENCODE(${action})},${UNIQUEID},${exten},${callerid},${account_id},${agents})
same => n,Gotoif($["${app}"="play"]?goto_play:)
same => n,Gotoif($["${app}"="say"]?goto_say:)
same => n,Gotoif($["${app}"="collect"]?goto_collect:)
same => n,Gotoif($["${app}"="dial_number"]?goto_dial_number:)
same => n,Gotoif($["${app}"="dial_sip"]?goto_dial_sip:)
same => n,Gotoif($["${app}"="voicemail"]?goto_voicemail:)
same => n,Gotoif($["${app}"="voicebot"]?goto_voicebot:)
same => n(goto_play),Goto(play,s,1)
same => n,Hangup()
same => n(goto_say),Goto(say,s,1)
same => n,Hangup()
same => n(goto_collect),Goto(collect,s,1)
same => n,Hangup()
same => n(goto_dial_number),Goto(dial_number,s,1)
same => n,Hangup()
same => n(goto_dial_sip),Goto(dial_sip,s,1)
same => n,Hangup()
same => n(goto_voicemail),Goto(voicemail,s,1)
same => n,Hangup()
same => n(goto_voicebot),Goto(voicebot,s,1)
same => n,Hangup()

[voicemail]
exten => s,1,Noop(Voicemail App...)
same => n,Noop(Voicemail message is ${text})
same => n,Set(text=${URIENCODE(${text})})
same => n,System(python3 /var/lib/asterisk/agi-bin/cpass/text_to_speech_cpass.py ${UNIQUEID}_say ${text} ${voice})
same => n,System(sox /tmp/${UNIQUEID}_say.wav -r 8000 /tmp/${UNIQUEID}_say1.wav)
same => n,Playback(/tmp/${UNIQUEID}_say1)
same => n,System(rm /tmp/${UNIQUEID}_say.wav)
same => n,System(rm /tmp/${UNIQUEID}_say1.wav)
same => n,Record(${PROMPTPATH}${UNIQUEID}.wav,,${maxduration})
same => n,Noop(RecordStatus is ${RECORD_STATUS})
same => n,Gotoif($["${RECORD_STATUS}"!="ERROR"]?goto_success:goto_fail)
same => n(goto_success),Noop(Playback message is ${successtext})
same => n,Set(successtext=${URIENCODE(${successtext})})
same => n,System(python3 /var/lib/asterisk/agi-bin/cpass/text_to_speech_cpass.py ${UNIQUEID}_say ${successtext} ${voice})
same => n,System(sox /tmp/${UNIQUEID}_say.wav -r 8000 /tmp/${UNIQUEID}_say1.wav)
same => n,Playback(/tmp/${UNIQUEID}_say1)
same => n,System(rm /tmp/${UNIQUEID}_say.wav)
same => n,System(rm /tmp/${UNIQUEID}_say1.wav)
same => n,AGI(cpass/voicemail_recording.py,${UNIQUEID},${exten},${callerid},${account_id},${RECORD_STATUS},${RECORDED_FILE},${URIENCODE(${action})})
same => n,Hangup()
same => n(goto_fail),Noop(Playback message is ${errortext})
same => n,Set(errortext=${URIENCODE(${errortext})})
same => n,System(python3 /var/lib/asterisk/agi-bin/cpass/text_to_speech_cpass.py ${UNIQUEID}_say ${errortext} ${voice})
same => n,System(sox /tmp/${UNIQUEID}_say.wav -r 8000 /tmp/${UNIQUEID}_say1.wav)
same => n,Playback(/tmp/${UNIQUEID}_say1)
same => n,System(rm /tmp/${UNIQUEID}_say.wav)
same => n,System(rm /tmp/${UNIQUEID}_say1.wav)
same => n,Hangup()

[voicebot]
exten => s,1,Noop(Voicebot App...)
same => n,Noop(${text})
same => n,Set(text=${URIENCODE(${text})})
same => n,System(python3 /var/lib/asterisk/agi-bin/cpass/text_to_speech_cpass.py ${UNIQUEID}_say ${text} ${voice})
same => n,System(sox /tmp/${UNIQUEID}_say.wav -r 8000 /tmp/${UNIQUEID}_say1.wav)
same => n,MixMonitor(,r(/tmp/${UNIQUEID}.wav)i(mix_mon_id))
same => n,BackGroundDetect(/tmp/${UNIQUEID}_say1,${silence},${minspeaktime})
same => n,BackGroundDetect(silence/5,${silence},${minspeaktime})
same => n,BackGroundDetect(/tmp/${UNIQUEID}_say1,${silence},${minspeaktime})
same => n,BackGroundDetect(silence/5,${silence},${minspeaktime})
same => n,BackGroundDetect(/tmp/${UNIQUEID}_say1,${silence},${minspeaktime})
same => n,WaitExten(2)

exten => talk,1,Noop(Talk detection completed....)
same => n,StopMixMonitor(${mix_mon_id})
same => n,System(rm /tmp/${UNIQUEID}_say.wav)
same => n,System(rm /tmp/${UNIQUEID}_say1.wav)
same => n,System(sox /tmp/${UNIQUEID}.wav /tmp/${UNIQUEID}-1.wav silence 1 0.1 1%)
same => n,AGI(cpass/speech_to_text.py,/tmp/${UNIQUEID}-1)
same => n,Noop(The Intent : ${intent} EntityName : ${entity_name} EntityValue : ${entity_value} Entities : ${entities})
same => n,System(rm /tmp/${UNIQUEID}.wav)
same => n,System(rm /tmp/${UNIQUEID}-1.wav)
same => n,AGI(cpass/voicebot_action.py,${UNIQUEID},${exten},${callerid},${account_id},talk,${intent},${entity_name},${entity_value},${action},${entities})
same => n,Gotoif($["${app}"="play"]?goto_play:)
same => n,Gotoif($["${app}"="say"]?goto_say:)
same => n,Gotoif($["${app}"="collect"]?goto_collect:)
same => n,Gotoif($["${app}"="dial_number"]?goto_dial_number:)
same => n,Gotoif($["${app}"="dial_sip"]?goto_dial_sip:)
same => n,Gotoif($["${app}"="voicemail"]?goto_voicemail:)
same => n,Gotoif($["${app}"="voicebot"]?goto_voicebot:)
same => n(goto_play),Goto(play,s,1)
same => n,Hangup()
same => n(goto_say),Goto(say,s,1)
same => n,Hangup()
same => n(goto_collect),Goto(collect,s,1)
same => n,Hangup()
same => n(goto_dial_number),Goto(dial_number,s,1)
same => n,Hangup()
same => n(goto_dial_sip),Goto(dial_sip,s,1)
same => n,Hangup()
same => n(goto_voicemail),Goto(voicemail,s,1)
same => n,Hangup()
same => n(goto_voicebot),Goto(voicebot,s,1)
same => n,Hangup()

exten => t,1,Noop(Time out happened...)
same => n,System(rm /tmp/${UNIQUEID}.wav)
;same => n,Goto(${CONTEXT},${exten},1)
same => n,AGI(cpass/voicebot_action.py,${UNIQUEID},${exten},${callerid},${account_id},timeout,,,,${action},${entities})
same => n,Gotoif($["${app}"="play"]?goto_play:)
same => n,Gotoif($["${app}"="say"]?goto_say:)
same => n,Gotoif($["${app}"="collect"]?goto_collect:)
same => n,Gotoif($["${app}"="dial_number"]?goto_dial_number:)
same => n,Gotoif($["${app}"="dial_sip"]?goto_dial_sip:)
same => n,Gotoif($["${app}"="voicemail"]?goto_voicemail:)
same => n,Gotoif($["${app}"="voicebot"]?goto_voicebot:)
same => n(goto_play),Goto(play,s,1)
same => n,Hangup()
same => n(goto_say),Goto(say,s,1)
same => n,Hangup()
same => n(goto_collect),Goto(collect,s,1)
same => n,Hangup()
same => n(goto_dial_number),Goto(dial_number,s,1)
same => n,Hangup()
same => n(goto_dial_sip),Goto(dial_sip,s,1)
same => n,Hangup()
same => n(goto_voicemail),Goto(voicemail,s,1)
same => n,Hangup()
same => n(goto_voicebot),Goto(voicebot,s,1)
same => n,Hangup()
